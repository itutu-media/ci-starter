"use strict";var KTLogin=function(){var _login,_showForm=function(form){$(".login-message").hide();var cls="login-"+form+"-on",form="kt_login_"+form+"_form";$("#"+form)[0].reset(),$("#"+form).find("input").removeClass("is-valid is-invalid"),_login.removeClass("login-forgot-on"),_login.removeClass("login-signin-on"),_login.removeClass("login-signup-on"),_login.removeClass("login-resend-on"),_login.removeClass("login-reset-on"),_login.addClass(cls),KTUtil.animateClass(KTUtil.getById(form),"animate__animated animate__backInUp")},_handleSignInForm=function(){var validation;validation=FormValidation.formValidation(KTUtil.getById("kt_login_signin_form"),{fields:{login:{validators:{notEmpty:{message:lang.login.emailRequired}}},password:{validators:{notEmpty:{message:lang.login.passwordRequired}}}},plugins:{trigger:new FormValidation.plugins.Trigger,submitButton:new FormValidation.plugins.SubmitButton,bootstrap:new FormValidation.plugins.Bootstrap}}),$("#kt_login_signin_submit").on("click",(function(e){e.preventDefault(),validation.validate().then((function(status){"Valid"==status?($.ajax({type:"POST",url:HOST_URL+"/login",dataType:"JSON",data:$("#kt_login_signin_form").serialize(),beforeSend:function(){showLoading()},success:function(response){200==response.status?window.location.replace(response.redirect):303==response.status?window.location.href=response.redirect:showMessage(response.message)},error:function(){showMessage(lang.global.error)},complete:function(){hideLoading()}}),KTUtil.scrollTop()):KTUtil.scrollTop()}))})),$("#kt_login_forgot").on("click",(function(e){e.preventDefault(),_showForm("forgot")})),$("#kt_login_signup").on("click",(function(e){e.preventDefault(),_showForm("signup")}))},_handleSignUpForm=function(e){var validation,form=KTUtil.getById("kt_login_signup_form");validation=FormValidation.formValidation(form,{fields:{fullname:{validators:{notEmpty:{message:lang.register.fullNameRequired}}},email:{validators:{notEmpty:{message:lang.global.emailRequired},emailAddress:{message:lang.global.emailInvalid}}},username:{validators:{notEmpty:{message:lang.register.usernameRequired}}},password:{validators:{notEmpty:{message:lang.register.passwordRequired}}},cpassword:{validators:{notEmpty:{message:lang.register.cPasswordRequired},identical:{compare:function(){return form.querySelector('[name="password"]').value},message:lang.register.cPasswordInvalid}}},agree:{validators:{notEmpty:{message:lang.register.agreeRequired}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap}}),$("#kt_login_signup_submit").on("click",(function(e){e.preventDefault(),validation.validate().then((function(status){"Valid"==status?($.ajax({type:"POST",url:HOST_URL+"/register",dataType:"JSON",data:$("#kt_login_signup_form").serialize(),beforeSend:function(){showLoading()},success:function(response){200==response.status?window.location.replace(response.redirect):(response.status,showMessage(response.message))},error:function(){showMessage(lang.global.error)},complete:function(){hideLoading()}}),KTUtil.scrollTop()):KTUtil.scrollTop()}))})),$("#kt_login_signup_cancel").on("click",(function(e){e.preventDefault(),_showForm("signin")}))},_handleForgotForm=function(e){var validation;validation=FormValidation.formValidation(KTUtil.getById("kt_login_forgot_form"),{fields:{email:{validators:{notEmpty:{message:lang.global.emailRequired},emailAddress:{message:lang.global.emailInvalid}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap}}),$("#kt_login_forgot_submit").on("click",(function(e){e.preventDefault(),validation.validate().then((function(status){"Valid"==status?($.ajax({type:"POST",url:HOST_URL+"/forgot-password",dataType:"JSON",data:$("#kt_login_forgot_form").serialize(),beforeSend:function(){showLoading()},success:function(response){200==response.status?(_showForm("reset"),showMessage(response.message,"success")):(response.status,showMessage(response.message))},error:function(){showMessage(lang.global.error)},complete:function(){hideLoading()}}),KTUtil.scrollTop()):KTUtil.scrollTop()}))})),$("#kt_login_forgot_cancel").on("click",(function(e){e.preventDefault(),_showForm("signin")}))},_handleResendForm=function(e){var validation,form=KTUtil.getById("kt_login_resend_form");validation=FormValidation.formValidation(form,{fields:{email:{validators:{notEmpty:{message:lang.global.emailRequired},emailAddress:{message:lang.global.emailInvalid}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap}}),$("#kt_login_resend_submit").on("click",(function(e){e.preventDefault(),validation.validate().then((function(status){"Valid"==status?($.ajax({type:"GET",url:HOST_URL+"/resend-activate-account",dataType:"JSON",data:$("#kt_login_resend_form").serialize(),beforeSend:function(){showLoading()},success:function(response){200==response.status?showMessage(response.message,"success"):showMessage(response.message)},error:function(){showMessage(lang.global.error)},complete:function(){hideLoading()}}),KTUtil.scrollTop()):KTUtil.scrollTop()}))}))},_handleResetForm=function(e){var validation,form=KTUtil.getById("kt_login_reset_form");validation=FormValidation.formValidation(form,{fields:{email:{validators:{notEmpty:{message:lang.global.emailRequired},emailAddress:{message:lang.global.emailInvalid}}},password:{validators:{notEmpty:{message:lang.register.passwordRequired}}},cpassword:{validators:{notEmpty:{message:lang.register.cPasswordRequired},identical:{compare:function(){return form.querySelector('[name="password"]').value},message:lang.register.cPasswordInvalid}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap}}),$("#kt_login_reset_submit").on("click",(function(e){e.preventDefault(),validation.validate().then((function(status){"Valid"==status?($.ajax({type:"POST",url:HOST_URL+"/reset-password",dataType:"JSON",data:$("#kt_login_reset_form").serialize(),beforeSend:function(){showLoading()},success:function(response){200==response.status?(_showForm("signin"),showMessage(response.message,"success")):(response.status,showMessage(response.message))},error:function(){showMessage(lang.global.error)},complete:function(){hideLoading()}}),KTUtil.scrollTop()):KTUtil.scrollTop()}))}))};return{init:function(){_login=$("#kt_login"),_handleSignInForm(),_handleSignUpForm(),_handleForgotForm(),_handleResendForm(),_handleResetForm(),_showForm(FORM)}}}();function showMessage(message,status="danger"){$(".login-message").removeClass("bg-danger bg-success"),$(".login-message").addClass("bg-"+status),$(".login-message").html(message),$(".login-message").slideDown()}function showLoading(){$(".card").addClass("overlay overlay-block"),$(".overlay-layer").show(),$(".login-message").slideUp()}function hideLoading(){$(".card").removeClass("overlay overlay-block"),$(".overlay-layer").hide()}jQuery(document).ready((function(){KTLogin.init()}));